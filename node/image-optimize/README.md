# image-optimize

> 从图片的数量和大小两个维度优化图片的加载

### 一、独立的图片服务器

##### 1、Cookie Free

  在前端的开发中，我们通常会通过Cookie来保存用户信息等。而这些Cookie会自动添加到我们的请求上，以便后端能够处理Cookie中的键值对。

  在实际开发中，并不是所有的请求都能用到我们存储的Cookie，例如图片等静态文件。

  大量静态资源携带上这些无效的Cookie带来的影响也不小。

  对于一个网站，图片资源占比很大，通过独立域名的图片服务器可以解决无效Cookie带来的影响。

##### 2、浏览器限制单个域名下的并发请求

  浏览器对每个域名的并发请求数是有限制的（C10K问题），当网站首页请求大量同域名下的请求时，无疑会造成请求的堵塞，从而影响网站加载速度。

##### 3、代价

  当我们通过引入多域名来突破浏览器并行请求数量限制来提高网站的加载速度，带来的问题就是DNS解析的代价。这里可以采用DNS预解析缓存：

```html
  <!-- 淘宝 -->
  <link ref="dns-prefetch" href="//g.alicdn.com">
  <link ref="dns-prefetch" href="//img.alicdn.com">
  <link ref="dns-prefetch" href="//tce.alicdn.com">
```

### 二、缩减Http请求次数

  前面也提到了浏览器对于并行请求的数量是有限制的，那么我们可以通过各种方式去缩减图片的请求次数：

##### 1、雪碧图

  将许多张小图拼接成大图，再通过CSS的background和background-position获取大图中的小图。

##### 2、base64

  对于一些小于2kb的小图base64直接存储再CSS中，从而减少http请求。

##### 3、iconfont

  随着css3的出现，我们也有更多的玩法，很多以前需要通过图片完成的设计效果，完全可以通过CSS3完成。最让人惊艳的就是iconfont的出现，通过CSS3中自定义字体@font-face以及SVG让我们以更加优雅的方式处理网站中的小图。

##### 4、图片懒加载


##### 5、图片预加载

##### 6、采用webp


