<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>
<body>
  <script>
    window.onerror = (msg, url, line, col, error) => {
      console.log(msg)
      console.log(url)
      console.log(line)
      console.log(col)
      console.log(error)
      return true
    }
  </script>

  <script>
    
    // window.onerror 可以捕获到运行时错误 和 语法错误 以及堆栈信息
    // try catch 只能捕获到运行时 错误 但是无法捕获异步错误 对性能有影响（尽量不要在其中声明过多的变量，最好是通过调用函数执行 http://taobaofed.org/blog/2015/10/28/try-catch-runing-problem/）

    // 采用 图片ping 的方式 上报数据（重复提交 时间戳 缓存？）

    // badjs 离线日志 indexedDB

    // computeStackTrace 统一格式化信息调用栈（由于各个浏览器返回 Error 调用栈的信息各不相同） 对于不返回调用栈的 采用 caller  向上回溯函数的调用栈
    // 对于基本函数的包装 或者叫 劫持

    // 1、异常收集  2、异常上报 (post)

    // 需要解决的问题
    // 前端该如何做好异常处理 --> JavaScript 错误处理 --> 异步函数的错误处理
    // 异常收集 1、computeStackTrace 统一格式化信息调用栈 2、对于基本函数的包装 (劫持) 3、IndexedDB 离线日志
    // 异常上报 1、图像ping （内存被回收 发送不了， 虽然加了时间戳， 但是还是无法避免重复）2、post


    /* eslint-disable */
    window.onload = () => {

      var a = 1
      console.log(b)  
      console.log(a)
    }
  </script>
</body>
</html>