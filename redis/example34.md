# 紧凑列表

  Redis5.0中又引入了新的数据结构listpack，它是对ziplist结构的改造，相比较的好处：

  - 空间更加节省
  - 结构更加简洁

```js
  ++++++++++++++++++++++++++++++++++++++++++++++++++
  + total_bytes + size + entry + ... + entry + end +
  ++++++++++++++++++++++++++++++++++++++++++++++++++
```

  相比少了一个记录尾部元素距离列表起点长度的字段，那么这里通过上面来计算呢？entry中不再记录前一个元素的长度，而是记录当前元素的长度，这样通过total_bytes和最后一个元素的长度则可以计算出zltail_offset。

  这样的好处是彻底解决级联更新的问题。

  不过由于ziplist应用广泛，listpack目前只应用在Stream中。