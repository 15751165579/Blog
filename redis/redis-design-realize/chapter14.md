# 复制

  在Redis的主从模式中，需要了解主从服务器是如何保持数据的一致性的。

### 主从服务器的配置

  对于主从服务器的配置可以通过slaveof命令，可以修改配置文件，也可以通过客户端执行。

### Redis2.8之前的从主同步策咯

  同步策咯采用sync方法：

  - 1）从服务器启动时，向主服务器请求同步。
  - 2）主服务器通过BGSAVE生成RDB文件，发送给从服务器。
  - 3）主服务器同时将这段时间缓冲区存放的写命令也发送给从服务器。
  - 4）从服务器载入RDB文件并且执行缓冲区的写命令，从而达到与主服务器一致的状态。
  - 5）接下来主服务器会通过命令传播的方式，将写命令同步给各个从服务器。

  这一切看起来都很完美，但是需要主从服务器断线的情况：

  - 从服务器只能通过再次向主服务器索要RDB文件，才能满足一致性的要求，这无形中浪费了很多资源。