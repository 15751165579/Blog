# Redis安全通信

  Redis本身是不支持SSL安全链接，那么就得通过SSL代理工具完成，官方推荐spiped。

### 原理

  这里先了解一下ssh的原理：

  - 远程主机接收到登录请求，将自己的公钥发给用户；
  - 用户使用这个公钥将登录密码加密后，发送给远程主机；
  - 远程主机通过自己的私钥解密密码，如果密码正确则允许登录。

  整个过程是安全的，但是如果有人冒充远程主机，那么就能截获我们的密码（主要ssh不像https协议有一个证书中心），这就是著名的中间人攻击

  ssh还提供公钥登录，可以省去每次登录输入密码的繁琐步骤。这种方式需要用户提供自己的公钥：

```s
  # 通过该命令生成公钥
  ssh-keygen
```

  - 客户端生成RSA的公钥和私钥
  - 客户端将自己的公钥发送到服务端
  - 客户端请求服务端的时候，服务端将一个随机字符串发送给客户端
  - 客户端用自己的私钥加密这个随机字符串然后发送给服务端
  - 服务端用客户端的公钥解密，如果正确，则不允许登录

  接下里我们看一下spiped的原理：

  - 首先客户端和服务端都需要安装spiped。
  - 客户端接收到Redis Client发送过来的请求数据通过spiped加密
  - 将加密数据发送到服务端的spiped进行解密
  - 将解密数据发送到Redis Server
  - 然后Redis Server再走一个反向数据流，将响应数据发送给Redis Client